<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFC Sound System</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<style>
body {
    margin: 0;
    background: #0a0a0a;
    color: #fff;
    font-family: 'Montserrat', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    text-align: center;
}
#playBtn {
    width: 230px;
    height: 230px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, #ff4b2b 0%, #ff416c 100%);
    color: white;
    font-size: 26px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 15px 40px rgba(255, 75, 43, 0.4);
    outline: none;
    margin-bottom: 25px;
}
#playBtn:active {
    transform: scale(0.92);
    box-shadow: 0 5px 15px rgba(255, 75, 43, 0.2);
}
#status { font-size: 16px; color: #aaa; line-height: 1.6; }
b { color: #ff4b2b; }
</style>
</head>
<body>

<button id="playBtn">PLAY</button>
<div id="status">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyCXnhsPcqTKsZbHxU67KEmm8FwHA1LhpPo",
    authDomain: "tagm-48ee0.firebaseapp.com",
    databaseURL: "https://tagm-48ee0-default-rtdb.firebaseio.com",
    projectId: "tagm-48ee0"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const params = new URLSearchParams(window.location.search);
const currentId = params.get('id');
const statusDiv = document.getElementById('status');
let audio = null;

if (!currentId) {
    statusDiv.innerHTML = "ID –º–µ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å—Å—ã–ª–∫–µ (?id=12345678)";
} else {
    statusDiv.innerHTML = `–ú–µ—Ç–∫–∞: <b>${currentId}</b><br>‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–≤—É–∫–∞...`;
    
    database.ref('tags/' + currentId).once('value').then(snap => {
        const val = snap.val();
        if (val && val.soundUrl && val.soundUrl !== "placeholder") {
            audio = new Audio(val.soundUrl);
            audio.preload = "auto";
            audio.load();
            statusDiv.innerHTML = `–ú–µ—Ç–∫–∞: <b>${currentId}</b><br>üöÄ –ì–æ—Ç–æ–≤ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é`;
        } else {
            statusDiv.innerHTML = `–ú–µ—Ç–∫–∞: <b>${currentId}</b><br>‚ö†Ô∏è –ó–≤—É–∫ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –±–æ—Ç–µ`;
        }
    }).catch(err => {
        console.error(err);
        statusDiv.innerText = "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ";
    });
}

document.getElementById('playBtn').onclick = () => {
    if (audio) {
        audio.currentTime = 0;
        audio.play();
        statusDiv.innerHTML = "üîä <b>–ò–ì–†–ê–ï–¢!</b>";
    } else {
        alert("–ó–≤—É–∫ –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤ –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –±–æ—Ç–µ.");
    }
};
</script>

</body>
</html>
